<!DOCTYPE html>
<html lang="es">
<head>
  <script src="js/translations.js"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Deli Pollo - Cat√°logo</title>

  <link rel="stylesheet" href="css/style.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    :root {
      --rojo: #f44336;
      --rojo-hover: #d32f2f;
      --blanco: #ffffff;
      --gris-claro: #fffaf5;
    }

    body {
      background-color: var(--gris-claro);
      font-family: 'Segoe UI', sans-serif;
    }

    .navbar {
      background-color: var(--rojo) !important;
    }

    .btn-danger {
      background-color: var(--rojo);
      border-color: var(--rojo);
    }

    .btn-danger:hover {
      background-color: var(--rojo-hover);
      border-color: var(--rojo-hover);
    }

    .text-danger {
      color: var(--rojo) !important;
    }

    .bg-danger {
      background-color: var(--rojo) !important;
    }

    .card,
    .product-card,
    .modal-content {
      border: none !important;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .price-tag {
      background: #ffebee;
      color: var(--rojo);
    }

    /* Product cards */
    .product-card {
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      text-align: center;
      transition: transform 0.2s ease;
      height: 100%;
    }

    .product-card:hover {
      transform: translateY(-5px);
    }

    .product-card img {
      height: 160px;
      object-fit: contain;
      margin-top: 15px;
    }

    .price-tag {
      background: #f8d7da;
      color: #b71c1c;
      border-radius: 20px;
      padding: 4px 15px;
      display: inline-block;
      margin-top: 5px;
    }

    /* Badge para el carrito */
    .cart-badge {
      font-size: 0.7rem;
    }

    /* Estilos para el modo administrador */
    .admin-badge {
      font-size: 0.7rem;
    }
  </style>
</head>

<body>
  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container d-flex justify-content-between align-items-center">
      <a class="navbar-brand fw-bold" href="Menu.html">
        <i class="bi bi-house-door-fill"></i> Deli Pollo
      </a>

      <div class="d-flex align-items-center">
        <a href="Carrito.html" class="btn me-2 position-relative">
          <i class="bi bi-cart-fill"></i>
          <span id="cartBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger cart-badge" style="display: none;">
            0
          </span>
        </a>

        <!-- Dropdown Configuraci√≥n -->
        <div class="dropdown">
          <button class="btn dropdown-toggle" type="button" id="configDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-gear-fill"></i>
            <span id="adminBadge" class="admin-badge badge bg-warning ms-1" style="display: none;">Admin</span>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="configDropdown">
            <li><a class="dropdown-item" href="MenuInicioSesion.html">Mi cuenta</a></li>
            <li><a class="dropdown-item" href="SobreNosotros.html">Sobre Nosotros</a></li>
            <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#languageModal">Idioma</a></li>
            <li id="adminMenuItem" style="display: none;"><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#adminModal">Panel Admin</a></li>
            <li>
              <hr class="dropdown-divider">
            </li>
            <li id="loginMenuItem"><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#loginModal">Iniciar sesi√≥n</a></li>
            <li id="logoutMenuItem" style="display: none;"><a class="dropdown-item text-danger" href="#" onclick="logout()">Cerrar sesi√≥n</a></li>
          </ul>
        </div>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <header class="hero text-center">
    <div class="container">
      <h1 class="display-4 fw-bold">¬°El mejor pollo de la ciudad!</h1>
      <p class="lead">Fresco, jugoso y con el aut√©ntico sabor de casa.</p>
    </div>
  </header>

  <!-- CAT√ÅLOGO -->
  <section id="catalogo" class="py-5">
    <div class="container">
      <div class="row g-4">
        <!-- Sidebar -->
        <div class="col-md-3">
          <div class="sidebar">
            <h5 class="fw-bold mb-3">Categor√≠as</h5>
            <div class="form-check form-switch">
              <input class="form-check-input category-filter" type="checkbox" id="bebidas" value="bebidas" checked>
              <label class="form-check-label" for="bebidas">Bebidas</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input category-filter" type="checkbox" id="comida" value="comida" checked>
              <label class="form-check-label" for="comida">Comida</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input category-filter" type="checkbox" id="postres" value="postres">
              <label class="form-check-label" for="postres">Postres</label>
            </div>
            <div class="form-check form-switch">
              <input class="form-check-input category-filter" type="checkbox" id="acompanamientos" value="acompanamientos">
              <label class="form-check-label" for="acompanamientos">Acompa√±amientos</label>
            </div>

            <hr>
            <h5 class="fw-bold mb-3">Filtro por precio</h5>
            <input type="range" class="form-range" min="500" max="10000" id="filtroPrecio">
            <div class="d-flex justify-content-between">
              <span>‚Ç°500</span>
              <span>‚Ç°10,000</span>
            </div>
            <div class="mt-2 text-center">
              <span id="priceRangeValue">‚Ç°0 - ‚Ç°10,000</span>
            </div>
          </div>
        </div>

        <!-- Contenido principal -->
        <div class="col-md-9">
          <!-- Barra de b√∫squeda -->
          <div class="search-bar mb-4">
            <form class="d-flex justify-content-start" id="searchForm">
              <input class="form-control me-2" type="search" id="searchInput" placeholder="Buscar producto..." aria-label="Buscar">
              <button class="btn btn-danger" type="submit"><i class="bi bi-search"></i></button>
            </form>
          </div>

          <!-- Productos -->
          <div class="row g-4" id="productosContainer">
            <!-- Los productos se cargar√°n din√°micamente aqu√≠ -->
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="bg-danger text-white py-4 mt-5">
    <div class="container text-center">
      <p class="mb-1">üìç Calle del Sabor #123, Ciudad de M√©xico</p>
      <p class="mb-2">üìû 55 1234 5678 | ‚úâÔ∏è contacto@delipollo.com</p>
      <div class="mb-3">
        <a href="#" class="text-white me-3"><i class="bi bi-facebook"></i></a>
        <a href="#" class="text-white me-3"><i class="bi bi-instagram"></i></a>
        <a href="#" class="text-white"><i class="bi bi-twitter-x"></i></a>
      </div>
      <p class="mb-0">¬© 2025 Deli Pollo - Todos los derechos reservados</p>
    </div>
  </footer>

  <!-- Modal de Idioma -->
  <div class="modal fade" id="languageModal" tabindex="-1" aria-labelledby="languageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content shadow-lg rounded-4">
        <div class="modal-header border-0">
          <h5 class="modal-title w-100 text-center fw-bold" id="languageModalLabel">Idioma</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="text-center mb-3">
            <i class="bi bi-globe" style="font-size: 5rem; color: #f44336;"></i>
          </div>
          <p class="text-center text-muted mb-4">
            Selecciona tu idioma preferido:
          </p>
          <form id="languageForm">
            <div class="mb-3">
              <select class="form-select" id="languageSelect">
                <option value="es">Espa√±ol</option>
                <option value="en">English</option>
                <option value="fr">Fran√ßais</option>
              </select>
            </div>
            <div class="d-grid">
              <button type="submit" class="btn btn-danger">Guardar Cambios</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Login -->
  <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content shadow-lg rounded-4">
        <div class="modal-header border-0">
          <h5 class="modal-title w-100 text-center fw-bold" id="loginModalLabel">Inicio de Sesi√≥n</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="text-center mb-2">
            <i class="bi bi-person-circle" style="font-size: 5rem; color: gray;"></i>
          </div>
          <form id="loginForm">
            <div class="mb-2">
              <label for="usuario" class="form-label">Nombre de Usuario</label>
              <input type="text" class="form-control" id="usuario" placeholder="Ingrese su usuario" required>
            </div>
            <div class="mb-2">
              <label for="password" class="form-label">Contrase√±a</label>
              <input type="password" class="form-control" id="password" placeholder="Ingrese su contrase√±a" required>
            </div>
            <div class="d-grid mb-2">
              <button type="submit" class="btn btn-danger w-100">Ingresar</button>
            </div>
          </form>
          <div class="text-center mb-2">
            <p class="text-muted">O inicia sesi√≥n con</p>
            <div class="d-flex justify-content-center gap-3 flex-wrap">
              <button class="btn btn-outline-danger"><i class="bi bi-google me-2"></i>Google</button>
              <button class="btn btn-outline-primary"><i class="bi bi-facebook me-2"></i>Facebook</button>
            </div>
          </div>
          <div class="text-center mt-4">
            <a href="#" data-bs-toggle="modal" data-bs-target="#resetModal" data-bs-dismiss="modal">üîë Restablecer contrase√±a</a>
            <a href="#" class="d-block" data-bs-toggle="modal" data-bs-target="#registerModal" data-bs-dismiss="modal">üßæ Crear una cuenta</a>
            <a href="Menu.html" class="d-block">üë§ Ingresar como invitado</a>
          </div>
        </div>
        <div class="modal-footer bg-light border-0 d-flex flex-column align-items-center mt-1">
          <p class="mb-2 fw-semibold">Cont√°ctanos:</p>
          <div class="d-flex flex-column align-items-center">
            <p class="mb-1"><i class="bi bi-envelope-fill me-2 text-primary"></i>DelpolloAttCli@gmail.com</p>
            <p class="mb-0"><i class="bi bi-whatsapp me-2 text-success"></i>+506 0000-0000</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Registro -->
  <div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content shadow-lg rounded-4">
        <div class="modal-header border-0">
          <h5 class="modal-title w-100 text-center fw-bold" id="registerModalLabel">Crear Cuenta</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="text-center mb-3">
            <i class="bi bi-person-circle" style="font-size: 5rem; color: gray;"></i>
          </div>
          <form id="registerForm">
            <div class="mb-3">
              <label for="nuevoUsuario" class="form-label">Nombre de Usuario</label>
              <input type="text" class="form-control" id="nuevoUsuario" placeholder="Ingrese su nombre de usuario" required>
            </div>
            <div class="mb-3">
              <label for="correo" class="form-label">Correo Electr√≥nico</label>
              <input type="email" class="form-control" id="correo" placeholder="Ingrese su correo electr√≥nico" required>
            </div>
            <div class="mb-3">
              <label for="nuevaPassword" class="form-label">Contrase√±a</label>
              <input type="password" class="form-control" id="nuevaPassword" placeholder="Cree una contrase√±a" required>
            </div>
            <div class="mb-3">
              <label for="confirmarPassword" class="form-label">Confirmar Contrase√±a</label>
              <input type="password" class="form-control" id="confirmarPassword" placeholder="Confirme su contrase√±a" required>
            </div>
            <div class="d-grid">
              <button type="submit" class="btn btn-danger">Crear Cuenta</button>
            </div>
          </form>
        </div>
        <div class="modal-footer bg-light border-0 d-flex flex-column align-items-center mt-3">
          <p class="text-muted">¬øYa tienes una cuenta?</p>
          <a href="#" data-bs-toggle="modal" data-bs-target="#loginModal" data-bs-dismiss="modal">Inicia Sesi√≥n</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Restablecer Contrase√±a -->
  <div class="modal fade" id="resetModal" tabindex="-1" aria-labelledby="resetModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content shadow-lg rounded-4">
        <div class="modal-header border-0">
          <h5 class="modal-title w-100 text-center fw-bold" id="resetModalLabel">Restablecer Contrase√±a</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="text-center mb-3">
            <i class="bi bi-key-fill" style="font-size: 5rem; color: gray;"></i>
          </div>
          <p class="text-center text-muted mb-4">
            Ingresa tu correo electr√≥nico para recibir un enlace de restablecimiento de contrase√±a.
          </p>
          <form id="resetForm">
            <div class="mb-3">
              <label for="correoReset" class="form-label">Correo Electr√≥nico</label>
              <input type="email" class="form-control" id="correoReset" placeholder="Ingrese su correo" required>
            </div>
            <div class="d-grid">
              <button type="submit" class="btn btn-danger fw-semibold">Enviar enlace</button>
            </div>
          </form>
        </div>
        <div class="modal-footer bg-light border-0 d-flex flex-column align-items-center mt-3">
          <p class="text-muted">¬øRecordaste tu contrase√±a?</p>
          <a href="#" data-bs-toggle="modal" data-bs-target="#loginModal" data-bs-dismiss="modal">Volver a iniciar sesi√≥n</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Administrador -->
  <div class="modal fade" id="adminModal" tabindex="-1" aria-labelledby="adminModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content shadow-lg rounded-4">
        <div class="modal-header border-0">
          <h5 class="modal-title w-100 text-center fw-bold" id="adminModalLabel">Panel de Administraci√≥n</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="text-center mb-3">
            <i class="bi bi-shield-check" style="font-size: 5rem; color: #f44336;"></i>
          </div>
          
          <ul class="nav nav-tabs" id="adminTabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="products-tab" data-bs-toggle="tab" data-bs-target="#products" type="button" role="tab">Productos</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="combos-tab" data-bs-toggle="tab" data-bs-target="#combos" type="button" role="tab">Combos</button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="orders-tab" data-bs-toggle="tab" data-bs-target="#orders" type="button" role="tab">Pedidos</button>
            </li>
          </ul>
          
          <div class="tab-content p-3" id="adminTabContent">
            <div class="tab-pane fade show active" id="products" role="tabpanel">
              <h5>Gesti√≥n de Productos</h5>
              <button class="btn btn-success mb-3" data-bs-toggle="modal" data-bs-target="#addProductModal">Agregar Producto</button>
              <div class="table-responsive">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Nombre</th>
                      <th>Precio</th>
                      <th>Categor√≠a</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody id="productsTable">
                    <!-- Los productos se cargar√°n din√°micamente aqu√≠ -->
                  </tbody>
                </table>
              </div>
            </div>
            
            <div class="tab-pane fade" id="combos" role="tabpanel">
              <h5>Gesti√≥n de Combos</h5>
              <button class="btn btn-success mb-3" data-bs-toggle="modal" data-bs-target="#addComboModal">Agregar Combo</button>
              <div class="table-responsive">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Nombre</th>
                      <th>Precio</th>
                      <th>Productos</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody id="combosTable">
                    <!-- Los combos se cargar√°n din√°micamente aqu√≠ -->
                  </tbody>
                </table>
              </div>
            </div>
            
            <div class="tab-pane fade" id="orders" role="tabpanel">
              <h5>Gesti√≥n de Pedidos</h5>
              <div class="table-responsive">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Cliente</th>
                      <th>Total</th>
                      <th>Estado</th>
                      <th>Fecha</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody id="ordersTable">
                    <!-- Los pedidos se cargar√°n din√°micamente aqu√≠ -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Alert para mostrar mensajes -->
  <div id="customAlert" class="alert alert-success custom-alert" style="display: none;">
    <i class="bi bi-check-circle-fill me-2"></i>
    <span id="alertMessage"></span>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
    // ========== GESTI√ìN DE USUARIOS ==========
    
    // Funci√≥n para obtener usuarios del localStorage
    function getUsers() {
      return JSON.parse(localStorage.getItem('users')) || [];
    }
    
    // Funci√≥n para guardar usuarios en localStorage
    function saveUsers(users) {
      localStorage.setItem('users', JSON.stringify(users));
    }
    
    // Funci√≥n para obtener el usuario actual
    function getCurrentUser() {
      return JSON.parse(localStorage.getItem('currentUser')) || null;
    }
    
    // Funci√≥n para guardar el usuario actual
    function saveCurrentUser(user) {
      localStorage.setItem('currentUser', JSON.stringify(user));
    }
    
    // Funci√≥n para registrar un nuevo usuario
    function registerUser(username, email, password) {
      const users = getUsers();
      
      // Verificar si el usuario ya existe
      if (users.find(user => user.username === username)) {
        showAlert('El nombre de usuario ya existe', 'danger');
        return false;
      }
      
      if (users.find(user => user.email === email)) {
        showAlert('El correo electr√≥nico ya est√° registrado', 'danger');
        return false;
      }
      
      // Crear nuevo usuario
      const newUser = {
        id: Date.now(),
        username: username,
        email: email,
        password: password,
        isAdmin: username === 'admin' // Por simplicidad, el usuario 'admin' ser√° administrador
      };
      
      users.push(newUser);
      saveUsers(users);
      
      // Iniciar sesi√≥n autom√°ticamente
      saveCurrentUser(newUser);
      updateUIForUser(newUser);
      
      showAlert('¬°Cuenta creada exitosamente!');
      return true;
    }
    
    // Funci√≥n para iniciar sesi√≥n
    function loginUser(username, password) {
      const users = getUsers();
      const user = users.find(u => u.username === username && u.password === password);
      
      if (user) {
        saveCurrentUser(user);
        updateUIForUser(user);
        showAlert(`¬°Bienvenido, ${user.username}!`);
        return true;
      } else {
        showAlert('Usuario o contrase√±a incorrectos', 'danger');
        return false;
      }
    }
    
    // Funci√≥n para cerrar sesi√≥n
    function logout() {
      localStorage.removeItem('currentUser');
      updateUIForUser(null);
      showAlert('Sesi√≥n cerrada correctamente');
    }
    
    // Funci√≥n para actualizar la UI seg√∫n el usuario
    function updateUIForUser(user) {
      const loginMenuItem = document.getElementById('loginMenuItem');
      const logoutMenuItem = document.getElementById('logoutMenuItem');
      const adminMenuItem = document.getElementById('adminMenuItem');
      const adminBadge = document.getElementById('adminBadge');
      
      if (user) {
        loginMenuItem.style.display = 'none';
        logoutMenuItem.style.display = 'block';
        
        if (user.isAdmin) {
          adminMenuItem.style.display = 'block';
          adminBadge.style.display = 'inline';
        } else {
          adminMenuItem.style.display = 'none';
          adminBadge.style.display = 'none';
        }
      } else {
        loginMenuItem.style.display = 'block';
        logoutMenuItem.style.display = 'none';
        adminMenuItem.style.display = 'none';
        adminBadge.style.display = 'none';
      }
    }
    
    // ========== GESTI√ìN DE IDIOMA ==========
    
    // Funci√≥n para obtener el idioma actual
    function getCurrentLanguage() {
      return localStorage.getItem('language') || 'es';
    }
    
    // Funci√≥n para guardar el idioma
    function saveLanguage(language) {
      localStorage.setItem('language', language);
      applyLanguage(language);
    }
    
    // Funci√≥n para aplicar el idioma
    function applyLanguage(language) {
      const translations = {
        es: {
          // Textos en espa√±ol
        },
        en: {
          // Textos en ingl√©s
        },
        fr: {
          // Textos en franc√©s
        }
      };
      
      // Aqu√≠ se aplicar√≠an las traducciones a los elementos de la p√°gina
      // Por simplicidad, solo actualizamos el selector
      document.getElementById('languageSelect').value = language;
    }
    
    // ========== GESTI√ìN DE PRODUCTOS ==========
    
    // Base de datos de productos
    const productos = [
      {
        id: 1,
        nombre: "Pepsi 2L",
        precio: 1200,
        imagen: "img/pepsi 2.5-1.jpg",
        categoria: "bebidas",
        enlace: "Producto_Pepsi2.5.html"
      },
      {
        id: 2,
        nombre: "Papas Fritas",
        precio: 2500,
        imagen: "img/papas1.png",
        categoria: "acompanamientos",
        enlace: "Producto_Papas.html"
      },
      {
        id: 3,
        nombre: "Pollo 2ud",
        precio: 4500,
        imagen: "img/pollo1.png",
        categoria: "comida",
        enlace: "Producto_Pollo.html"
      },
      {
        id: 4,
        nombre: "Pepsi 350ml",
        precio: 350,
        imagen: "img/pepsi350-1.png",
        categoria: "bebidas",
        enlace: "Producto_Pepsi350.html"
      },
      {
        id: 5,
        nombre: "Helado de Vainilla",
        precio: 1500,
        imagen: "https://via.placeholder.com/300",
        categoria: "postres",
        enlace: "#"
      },
      {
        id: 6,
        nombre: "Arroz con Pollo",
        precio: 3200,
        imagen: "https://via.placeholder.com/300",
        categoria: "comida",
        enlace: "#"
      }
    ];
    
    // Funci√≥n para renderizar productos
    function renderProductos(productosFiltrados = productos) {
      const container = document.getElementById('productosContainer');
      let html = '';
      
      if (productosFiltrados.length === 0) {
        html = '<div class="col-12 text-center py-5"><h4>No se encontraron productos</h4></div>';
      } else {
        productosFiltrados.forEach(producto => {
          html += `
            <div class="col-md-4">
              <a href="${producto.enlace}" class="text-decoration-none">
                <div class="product-card p-3">
                  <img src="${producto.imagen}" alt="${producto.nombre}">
                  <h6 class="mt-3">${producto.nombre}</h6>
                  <span class="price-tag">‚Ç°${producto.precio.toLocaleString()}</span>
                </div>
              </a>
            </div>
          `;
        });
      }
      
      container.innerHTML = html;
    }
    
    // Funci√≥n para filtrar productos
    function filtrarProductos() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const priceRange = document.getElementById('filtroPrecio').value;
      const selectedCategories = Array.from(document.querySelectorAll('.category-filter:checked'))
        .map(checkbox => checkbox.value);
      
      const productosFiltrados = productos.filter(producto => {
        // Filtro por b√∫squeda
        const matchesSearch = producto.nombre.toLowerCase().includes(searchTerm);
        
        // Filtro por precio
        const matchesPrice = producto.precio <= priceRange;
        
        // Filtro por categor√≠a
        const matchesCategory = selectedCategories.length === 0 || selectedCategories.includes(producto.categoria);
        
        return matchesSearch && matchesPrice && matchesCategory;
      });
      
      renderProductos(productosFiltrados);
    }
    
    // ========== GESTI√ìN DEL CARRITO ==========
    
    // Funci√≥n para obtener el carrito del localStorage
    function getCart() {
      try {
        return JSON.parse(localStorage.getItem('cart')) || [];
      } catch (error) {
        console.error('Error al obtener el carrito:', error);
        return [];
      }
    }
    
    // Funci√≥n para guardar el carrito en localStorage
    function saveCart(cart) {
      try {
        localStorage.setItem('cart', JSON.stringify(cart));
        return true;
      } catch (error) {
        console.error('Error al guardar el carrito:', error);
        return false;
      }
    }
    
    // Funci√≥n para a√±adir producto al carrito
    function addToCart(name, price, image, quantity = 1) {
      let cart = getCart();
      quantity = parseInt(quantity) || 1;
      
      // Buscar si el producto ya est√° en el carrito
      const existingProductIndex = cart.findIndex(item => item.name === name);
      
      if (existingProductIndex !== -1) {
        // Producto existe, actualizar cantidad
        cart[existingProductIndex].quantity += quantity;
        showAlert(`Cantidad actualizada: ${cart[existingProductIndex].quantity} ${name}`);
      } else {
        // Producto nuevo, a√±adir al carrito
        cart.push({
          name: name,
          price: parseInt(price),
          image: image,
          quantity: quantity
        });
        showAlert(`¬°${name} a√±adido al carrito!`);
      }
      
      // Guardar carrito actualizado
      if (saveCart(cart)) {
        updateCartCount();
        return true;
      } else {
        showAlert('Error al a√±adir al carrito', 'danger');
        return false;
      }
    }
    
    // Funci√≥n para actualizar la cantidad en el √≠cono del carrito
    function updateCartCount() {
      const cart = getCart();
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      const cartBadge = document.getElementById('cartBadge');
      
      if (cartBadge) {
        if (totalItems > 0) {
          cartBadge.textContent = totalItems;
          cartBadge.style.display = 'block';
        } else {
          cartBadge.style.display = 'none';
        }
      }
    }
    
    // ========== GESTI√ìN DE ALERTAS ==========
    
    // Funci√≥n para mostrar alertas
    function showAlert(message, type = 'success') {
      const alert = document.getElementById('customAlert');
      const messageElement = document.getElementById('alertMessage');
      
      alert.className = `alert alert-${type} custom-alert`;
      messageElement.textContent = message;
      alert.style.display = 'block';
      
      setTimeout(() => {
        alert.style.display = 'none';
      }, 3000);
    }
    
    // ========== INICIALIZACI√ìN ==========
    
    document.addEventListener('DOMContentLoaded', function() {
      // Inicializar productos
      renderProductos();
      
      // Inicializar carrito
      updateCartCount();
      
      // Inicializar usuario
      const currentUser = getCurrentUser();
      updateUIForUser(currentUser);
      
      // Inicializar idioma
      const currentLanguage = getCurrentLanguage();
      applyLanguage(currentLanguage);
      
      // Configurar eventos de filtros
      document.getElementById('searchForm').addEventListener('submit', function(e) {
        e.preventDefault();
        filtrarProductos();
      });
      
      document.getElementById('searchInput').addEventListener('input', filtrarProductos);
      
      document.getElementById('filtroPrecio').addEventListener('input', function() {
        document.getElementById('priceRangeValue').textContent = `‚Ç°500 - ‚Ç°${this.value}`;
        filtrarProductos();
      });
      
      document.querySelectorAll('.category-filter').forEach(checkbox => {
        checkbox.addEventListener('change', filtrarProductos);
      });
      
      // Configurar formularios
      document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const username = document.getElementById('usuario').value;
        const password = document.getElementById('password').value;
        
        if (loginUser(username, password)) {
          const loginModal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
          loginModal.hide();
        }
      });
      
      document.getElementById('registerForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const username = document.getElementById('nuevoUsuario').value;
        const email = document.getElementById('correo').value;
        const password = document.getElementById('nuevaPassword').value;
        const confirmPassword = document.getElementById('confirmarPassword').value;
        
        if (password !== confirmPassword) {
          showAlert('Las contrase√±as no coinciden', 'danger');
          return;
        }
        
        if (registerUser(username, email, password)) {
          const registerModal = bootstrap.Modal.getInstance(document.getElementById('registerModal'));
          registerModal.hide();
        }
      });
      
      document.getElementById('resetForm').addEventListener('submit', function(e) {
        e.preventDefault();
        showAlert('Se ha enviado un enlace de restablecimiento a su correo');
        const resetModal = bootstrap.Modal.getInstance(document.getElementById('resetModal'));
        resetModal.hide();
      });
      
      document.getElementById('languageForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const language = document.getElementById('languageSelect').value;
        saveLanguage(language);
        showAlert('Idioma cambiado correctamente');
        const languageModal = bootstrap.Modal.getInstance(document.getElementById('languageModal'));
        languageModal.hide();
      });
      
      // Crear usuario administrador por defecto si no existe
      const users = getUsers();
      if (!users.find(user => user.username === 'admin')) {
        registerUser('admin', 'admin@delipollo.com', 'admin123');
      }
    });
  </script>
</body>
</html>
